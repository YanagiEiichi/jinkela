<script src="/tester.js"></script>
<script src="/jinkela.js"></script>
<script src="/directives/ref.js"></script>
<body>
<script>
var Foo = function() { Jinkela.apply(this, arguments); };
Foo.prototype = Object.create(Jinkela.prototype, {
  constructor: { configurable: true, value: Foo },
  template: {
    configurable: true,
    get: function() {
      return '<div><a href="javascript:" ref="a">Jinkela</a></div>';
    }
  }
});

var foo = new Foo().to(document.body);

var list = [];
for (var i = 0; i < 10; i++) {
  var div = document.createElement('div');
  div.textContent = '[' + i + ']';
  list.push(div);
}

foo.a = list;

var range = document.createRange();
range.setStart(list[1], 0);
range.setEnd(list[3], 1);
getSelection().addRange(range);

foo.a = list.slice(0, 5);

Tester.assert(range.collapsed === false, 'selection range must be protected');

Tester.feedback(true);
</script>
